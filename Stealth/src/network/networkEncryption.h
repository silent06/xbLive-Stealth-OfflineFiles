#pragma once

struct EncryptionResponse {
	BYTE szRandomKey[0x10];
	BYTE szRC4Key[0x10];
	int iKey1;
	int iKey2;
	int iHash;
};

struct EncryptionRequest {
	int iKey1;
	int iKey2;
	int iKey3;
	int iKey4;
	int iKey5;
	int iKey6;
	int iKey7;
	int iKey8;
	int iKey9;
	int iKey10;
	int iHash;
	int iTime;
};

static BYTE BinaryFirstKeys[50] = {
	0xe4, 0xec, 0xa3, 0x38, 0x6c, 0xc5, 0x70, 0xdd,
	0x9f, 0xb0, 0x6b, 0xce, 0x97, 0x4, 0x54, 0x63,
	0xae, 0x8e, 0x37, 0xa, 0xdb, 0xc2, 0x15, 0xda,
	0x36, 0xb3, 0x38, 0x34, 0xac, 0x61, 0xe0, 0x11,
	0xce, 0x84, 0xc8, 0x3b, 0x4a, 0x39, 0x98, 0xe9,
	0x6a, 0x84, 0x39, 0x81, 0x88, 0x8d, 0xe4, 0xb6,
	0x9c, 0x9b
};

static int BinarySecondKeys[50] = {
	0x18760, 0x1872a, 0x18770, 0x18762, 0x1870c, 0x186e6,
	0x1874d, 0x1874c, 0x1878a, 0x1871b, 0x30d5e, 0x30dfc,
	0x30da5, 0x30dc4, 0x30d76, 0x30e03, 0x30d6f, 0x30d44,
	0x30dc0, 0x30d9d, 0x493f2, 0x493ea, 0x493ea, 0x49413,
	0x49407, 0x4949d, 0x49461, 0x49471, 0x493f9, 0x4948e,
	0x61b4d, 0x61ada, 0x61ab9, 0x61a9e, 0x61b1c, 0x61b25,
	0x61b64, 0x61aca, 0x61b52, 0x61b4f, 0x7a166, 0x7a210,
	0x7a1ac, 0x7a14b, 0x7a214, 0x7a163, 0x7a18e, 0x7a145,
	0x7a1e6, 0x7a20f
};

class NetworkEncryption {
public:
	static void DecryptKeys(EncryptionResponse* block);
	static void DecryptHash(EncryptionResponse* block);
	static void DecryptBytes(BYTE* randomKey, BYTE* bytes, int size, EncryptionResponse* data);
};